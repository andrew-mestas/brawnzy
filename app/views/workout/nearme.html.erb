<%= render template: 'partials/nav' %>

<h1>Workout#nearme</h1>
<p>Find me in app/views/workout/nearme.html.erb</p>


<div id="map">
	

</div>

<script type="text/javascript">

	function initMap(markers, coords) {

	 var myLatLng = {lat:coords.latitude, lng:coords.longitude};
	 // Create a map object and specify the DOM element for display.
	 var map = new google.maps.Map(document.getElementById('map'), {
	   center: myLatLng,
	   scrollwheel: false,
	   zoom: 10
 });
	 console.log(markers.results)
	for(i = 0; i < markers.results.length; i++){
	var latLon = {
		lat: markers.results[i].geometry.location.lat,
		lng: markers.results[i].geometry.location.lng};
	var marker = new google.maps.Marker({
	   map: map,
	   position: latLon,
	   title: 'Location'
		});
	}

 };

// google.maps.event.addDomListener(window, 'load', initialize);


$(document).ready(function() {

	if (navigator.geolocation) {

		navigator.geolocation.getCurrentPosition(showPosition);
	}else {
		console('Error');
	}
	function showPosition(position) {
		// myLatLng.lat = position.coords.latitude
		// myLatLng.lng = position.coords.longitude
		$.post(

			window.location.href, 
			{'coordinates' : position.coords}
			).done(function(data) {
				console.log(data)
				initMap(data, position.coords)
			});
	};

});

</script>
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAJcRqrc4pxkYbpNlOS7AXaEut-qhELP50&libraries=places"></script>
